create image (.sif file):
    singularity build --fakeroot container.sif container.def

then run your code using singularity:
    singularity run container.sif run_training.py
    (you can run any command in the container using singularity run container.sif <command>)

send the job to the nodes:
    sbatch train.slurm
    (you can check the status of your job using squeue -u stud438)